---
title: "[読書メモ] Clean Architecture"
emoji: "📖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["book", "architecture", "読書感想文", "CleanArchitecture"]
published: false
---

こればな https://www.amazon.co.jp/dp/B07FSBHS2V

基本的に Web だけをやってきた人間として、Clean Architecture を読んでみて、心に移り行くよしなしごとをそこはかとなく
書きつくってみる。個人用メモ。

# 第 1,2 章

「機能を実装すること」と「数ヶ月後も変わらずに機能を実装できること」の両方が大事だが後者は（わざとではないにせよ）価値として注力されない場合がある。というお話。頷きすぎて首がもげる。

# 第 3,4,5,6 章

へーってなる。

# 第 7,8,9,10,11 章

（比較的）ミクロなレベルでの設計原則の話。このへんの考察は色んな人がブログ書いてて良い。

インターフェイス分離の原則だけは「きょうびの Web ではあんまり共感できないな。。。」などと思った。デプロイ単位が別れてればサーバーが別れているのが当たり前なので、記載されているようなデプロイを恐れる気持ちに共感できなかった。

# 第 12,13,14 章

コンポーネントの話。初っ端で説明されている通り、ここでいう「コンポーネント」というのは「デプロイの単位」のことである。

ここの感覚が筆者と昨今の Web 屋とではかなりの乖離があるように思う。昨今の Web ではデプロイ単位といえばサービス単位である。クラウドが発達して「サーバーマシンといえば仮想マシン」となった現在では、一つのマシンに複数モジュールを別々にデプロイすることはかなり稀なのではないだろうか。

とはいえ、上記を前提に置き、コンポーネントの単位 イコール サービスの単位と読み替えて読んでも、まぁまぁスラスラと読めるのは、序文にあったとおり「アーキテクチャのルールはどれも同じ」であるからなのだろう。

さっきは「デプロイを恐れる気持ちに共感できない」と言ったが、ここでは違う。サービス一つデプロイするのに、毎度芋づる式に要デプロイサービスが出てきては堪らん。

# 第 15,16,17 章

もっとも読み応えのある章なのではないだろうか。

水平方向と垂直方向の切り離しについての説明がされている。

「今たまたま共通なだけのロジック（未来に生き別れるロジック）を共通化するな」というところで頷きすぎて首がもげた。

DB の選択も UI の選択も、切り離し方式の選択も、いろんな決定を遅らせて開発を進める価値について説明されている。プラグインアーキテクチャを目指すことでこれを実現しようとするお話であると理解した。アーキテクチャに自信のない人間が初回からプラグインアーキテクチャの I/F 設計に成功するか、は別として、これを目指すべきなんだろうと思う。

一方で、レッドオーシャンで体験の磨き込みで戦う必要がある領域では、ビジネスドメインと同じくらいユーザーにとってのインターフェース（UI とは言っていない）の磨き込みに価値が出る場合がある。そういった場合にはもっとプロトタイプドリブンな開発方式と歩み寄る必要があるように思われる。しかし、それが持続的な開発性の維持を軽んじていい理由にはならない。

あとあと、上の話にも似てるけど、「選択肢を残すこと」よりも「今開発速度が高いこと」が優先されることってないのかなぁ。などと思う。もちろん「持続的な開発性の維持を軽んじていい理由」にはならないという前提で。  
ブラウザアプリケーション開発においては、SPA や Next などの「Web におけるフロントのためのコンポーネント」という概念がかなり一般化しており、UI とビジネスバックエンドが HTTP による境界を持つことはかなりデファクトスタンダードとなってきている。Web を前提として作り始めることが「境界のインターフェース間違えた 😭」につながることは少なくなってきているように思う。  
これが API モードじゃない RoR とかだと話が変わってくることには同意する。

この話、DB の選択においてはどうか。。。うーん 🤔。  
「DB の利用を抽象化しておくことで DB の技術選定を遅らせれる」ということのメリットは理解した上で、これでは特定の DB が持つ「アーキテクチャの設計に影響を及ぼしうる特性」の恩恵を受けづらくなるということがあると思う。いや「それらのあらゆる DB の恩恵を受ける判断をあとから決めれる」ということな気もする。  
うーん。思考するための経験値が足りてない。。。。

# 第 18 章

Web（とくにクラウドネイティブな Web）では、もう「モノリス」と「サービスでの境界」なんじゃないだろうか。1 マシンの中で実行ファイルや定義ファイルを切り分けて、別々でデプロイして実行するようなシーンは殆どないと思う。これは上記の 12,13,14 章のとこで述べたとおり。

# 第 19 章

「レベル」の考え方。よい。

# 第 20 章

DDD で言うところのドメイン層を（ドメインモデルを？）エンティティと呼びたい。と言っている。前章で出てきたレベルの話もあるので、この Clean Architecture のエンティティはリポジトリのようなものは持たなそう。サービスはどうだろうか？データとルールをエンティティに収めたるのだとしたら複数エンティティに跨るルールは、サービスのようなものに入れたくなるかもしれない。ただそれがユースケースではないのかは疑う必要があるはず。

# 第 21 章

コードベースで叫んでいきたい。

# 第 22 章

よく見るあれ。

# 第 23 章

テスタビリティを追求すると自然とやってるやつ。

# 第 24 章

手を抜いて境界作る方法が書かれてる。場合によってはこういうのもあり、と。

# 第 25 章

「未来のためのアーキテクチャ」と「YAGNI」の中間の話がよかった。

個人的には保守の安全性はテストで担保されるのが良いと思っている。なのでテスタビリティのためのアーキテクチャにならコストを払うべきな気がしている。

「アーキテクチャについて考えるのは一度きりではなく、常に見張り続けなければならない」というの、良い。

# 第 26 章

メインコンポーネントの話。良い。フレームワークによってはこれが隠されてたり、設定ファイルになってたりする場合がある。あれは個人的には好きではない。

# 第 27 章

「サービス分離とアーキテクチャは違う！」って言ってる。「へー」くらいの感想。

# 第 28 章

# 第 29 章

# 第 30 章

# 第 31 章

# 第 32 章

# 第 33 章

# 第 34 章
